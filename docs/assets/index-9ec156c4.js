(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?e.credentials="include":o.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function t(o){if(o.ep)return;o.ep=!0;const e=r(o);fetch(o.href,e)}})();class n{constructor(){this.viewer=new Cesium.Viewer("app",{imageryProvider:n.getImageryProvider(),baseLayerPicker:!1,geocoder:!1,timeline:!1,animation:!1,homeButton:!1,navigationInstructionsInitiallyVisible:!0,navigationHelpButton:!1,sceneModePicker:!1,fullscreenButton:!1}),this.toColor=!1}static getImageryProvider(){return new Cesium.WebMapTileServiceImageryProvider({url:"https://c.basemaps.cartocdn.com/light_nolabels/{TileMatrix}/{TileCol}/{TileRow}.png",layer:"carto-light",style:"default",format:"image/jpeg",maximumLevel:19,tileMatrixSetID:"default",credit:new Cesium.Credit('&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>')})}async toggle3DModel(){if(this.model3d)this.viewer.dataSources.remove(this.model3d),this.model3d=null;else{this.model3d=await Cesium.GeoJsonDataSource.load("./pa.geojson"),this.viewer.dataSources.add(this.model3d);const r=this.model3d.entities.values;for(var s=0;s<r.length;s++){const t=r[s];if(t.properties.horizontal){const o=Cesium.Color.FORESTGREEN.withAlpha(.7),e=Cesium.Color.FORESTGREEN.withAlpha(1);t.polygon.extrudedHeight=0,t.polygon.material=o,t.polygon.outlineColor=e}else{const o=Cesium.Color.GOLD.withAlpha(.7),e=Cesium.Color.GOLD.withAlpha(1);t.polygon.extrudedHeight=15,t.polygon.material=o,t.polygon.outlineColor=e}}this.viewer.zoomTo(this.model3d)}}togglePointCloud(){this.pointCloud?(this.viewer.scene.primitives.remove(this.pointCloud),this.pointCloud=null):(this.pointCloud=this.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:"./data/tileset.json"})),this.pointCloud.pointCloudShading.attenuation=!0,this.pointCloud.pointCloudShading.eyeDomeLighting=!0,this.pointCloud.style=new Cesium.Cesium3DTileStyle({color:"rgb(${Intensity}, ${Intensity}, ${Intensity})"}))}togglePOI(){this.poi?(this.viewer.dataSources.remove(this.poi),this.poi=null):(this.poi=new Cesium.GeoJsonDataSource,this.poi.load("./poi.geojson",{markerColor:Cesium.Color.fromCssColorString("#418BDC"),markerSymbol:"park",markerSize:50}),this.viewer.dataSources.add(this.poi))}toggleMust(){this.must?(this.viewer.dataSources.remove(this.must),this.must=null):(this.must=new Cesium.GeoJsonDataSource,this.must.load("./must.geojson",{markerColor:Cesium.Color.fromCssColorString("#CA4F43"),markerSymbol:"M",markerSize:50}),this.viewer.dataSources.add(this.must))}async colorMust(){this.toColor=!this.toColor;const r=(await fetch("./must.geojson").then(e=>e.json())).features.map(e=>e.properties.markerArray[0].buildingId);console.log(r);const t=this.model3d.entities.values;for(var o=0;o<t.length;o++){console.log("ECCO");const e=t[o];if(console.log(e.properties.sticazzi),console.log(e.properties.id),r.includes(e.properties.id._value)&&this.toColor){console.log("ECCO1");const i=Cesium.Color.RED.withAlpha(.7),l=Cesium.Color.RED.withAlpha(1);e.polygon.extrudedHeight=e.properties.horizontal?0:15,e.polygon.material=i,e.polygon.outlineColor=l}else if(e.properties.horizontal){const i=Cesium.Color.FORESTGREEN.withAlpha(.7),l=Cesium.Color.FORESTGREEN.withAlpha(1);e.polygon.extrudedHeight=0,e.polygon.material=i,e.polygon.outlineColor=l}else{const i=Cesium.Color.GOLD.withAlpha(.7),l=Cesium.Color.GOLD.withAlpha(1);e.polygon.extrudedHeight=15,e.polygon.material=i,e.polygon.outlineColor=l}}}}const a=new n;a.toggle3DModel();document.getElementById("btn-must").addEventListener("click",()=>{a.colorMust(),console.log("must")});document.getElementById("btn-las").addEventListener("click",()=>{a.togglePointCloud()});
